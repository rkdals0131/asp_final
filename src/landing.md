## π μ •λ°€ μ°©λ¥™ λ―Έμ… ν†µν•© κ°λ° κ³„νμ„ (v1.1)

### 1. μµμΆ… λ©ν‘

κΈ°μ΅΄ μ›¨μ΄ν¬μΈνΈ λ―Έμ… μν–‰ μ™„λ£ ν›„, UGVμ— λ¶€μ°©λ ArUco λ§μ»¤λ¥Ό μ‹¤μ‹κ°„μΌλ΅ μ¶”μ ν•μ—¬ λ“λ΅ μ΄ μ•μ •μ μΌλ΅ μ •λ°€ μ°©λ¥™(Precision Landing)ν•λ” κΈ°λ¥μ„ μ™„μ„±ν•©λ‹λ‹¤.

### 2. μ‹λ‚λ¦¬μ¤ λ¶„μ„

ν„μ¬ λ―Έμ…μ€ μµμΆ… μ›¨μ΄ν¬μΈνΈμ— λ„λ‹¬ν•λ©΄ `MISSION_COMPLETE_HOVER` μƒνƒμ— μ§„μ…ν•μ—¬ λ¬΄ν•μ • νΈλ²„λ§ν•©λ‹λ‹¤. μ΄ λ΅μ§μ„ μ •λ°€ μ°©λ¥™ μ‹λ‚λ¦¬μ¤λ΅ ν™•μ¥ν•©λ‹λ‹¤.

1.  **μ›¨μ΄ν¬μΈνΈ λ―Έμ…**: λ“λ΅ μ΄ μ‚¬μ „ μ„¤μ •λ μ›¨μ΄ν¬μΈνΈμ™€ μ‘μ‹ μ§€μ μ„ λ”°λΌ λΉ„ν–‰ν•©λ‹λ‹¤.
2.  **λ‘λ°λ¶€ μ§€μ  λ„μ°©**: λ§μ§€λ§‰ μ›¨μ΄ν¬μΈνΈ(μ°©λ¥™ μ¤€λΉ„ μ§€μ )μ— λ„μ°©ν•μ—¬ 2μ΄κ°„ νΈλ²„λ§μ„ μ™„λ£ν•©λ‹λ‹¤.
3.  **μ°©λ¥™ λ¨λ“ μ „ν™**:
    * `waypoint_mission_node`λ” `MISSION_COMPLETE_HOVER` μƒνƒ λ€μ‹ , μƒλ΅μ΄ **`PRECISION_LANDING`** μƒνƒλ΅ μ „ν™ν•©λ‹λ‹¤.
    * μ „ν™ μ§ν›„, `MissionComplete.srv` μ„λΉ„μ¤λ¥Ό μ΄μ©ν•΄ `mission_control_node`μ— `DRONE_START_PRECISION_LANDING (ID=6)` μ‹ νΈλ¥Ό μ „μ†΅ν•©λ‹λ‹¤.
4.  **λ§μ»¤ νƒμ§€ λ¨λ“ μ§€μ‹**:
    * `mission_control_node`λ” ID 6 μμ‹  μ‹, `multi_tracker_node`μ— μ°©λ¥™μ© λ§μ»¤(0.5m) νƒμ§€λ¥Ό μ§€μ‹ν•λ” `"DETECT_LANDING_MARKER"` λ©”μ‹μ§€λ¥Ό `/multi_tracker/command` ν† ν”½μΌλ΅ λ°ν–‰ν•©λ‹λ‹¤.
5.  **UGV λ„μ°© λ€κΈ° λ° ν•κ°• ν—κ°€**:
    * UGVκ°€ λ‘λ°λ¶€ μ§€μ μ— λ„μ°©ν•λ©΄ `UGV_RENDEZVOUS_ARRIVAL (ID=7)` μ‹ νΈλ¥Ό `mission_control_node`μ— μ „μ†΅ν•©λ‹λ‹¤.
    * `mission_control_node`λ” λ“λ΅ μ— `'ugv_arrived'` λ…λ Ήμ„ μ „μ†΅ν•μ—¬ ν•κ°• ν—κ°€λ¥Ό λ‚΄λ¦½λ‹λ‹¤.
    * UGV λ„μ°© μ „κΉμ§€λ” λ“λ΅ μ΄ λ§μ§€λ§‰ μ›¨μ΄ν¬μΈνΈμ—μ„ νΈλ²„λ§ν•λ©° λ€κΈ°ν•©λ‹λ‹¤.
6.  **λ‹¨κ³„λ³„ μ •λ°€ μ μ–΄ λ° ν•κ°•**:
    * **1λ‹¨κ³„ (λ§μ»¤ νƒμƒ‰)**: UGV λ„μ°© ν›„ λ§μ»¤ λ―Ένƒμ§€ μ‹, μ²μ²ν ν•κ°•ν•λ©° λ§μ»¤λ¥Ό νƒμƒ‰ν•©λ‹λ‹¤.
    * **2λ‹¨κ³„ (μν‰ μ •λ ¬)**: λ§μ»¤ νƒμ§€ μ‹ κ³ λ„λ¥Ό μ μ§€ν•λ©° λ§μ»¤ μ¤‘μ•™μΌλ΅ μν‰ μ΄λ™ν•©λ‹λ‹¤.
    * **3λ‹¨κ³„ (μ •λ°€ ν•κ°•)**: μν‰ μ •λ ¬ μ™„λ£ ν›„ λ§μ»¤ μ¤‘μ•™μ—μ„ μ²μ²ν ν•κ°•ν•©λ‹λ‹¤.
    * **4λ‹¨κ³„ (μ§€μ†μ  μ •λ°€ μ μ–΄)**: ν•κ°• μ¤‘ μ •λ ¬μ΄ λ²—μ–΄λ‚λ©΄ κ³ λ„ μ μ§€ν•λ©° μ¬μ •λ ¬
7.  **μ°©λ¥™ μ™„λ£**:
    * λ“λ΅ μ κ³ λ„μ™€ μν‰ μ¤μ°¨κ°€ μ—„κ²©ν• μ„κ³„κ°’ μ΄λ‚΄λ΅ μ§„μ…ν•λ©΄, μµμΆ… `LANDING` μƒνƒλ΅ μ „ν™ν•μ—¬ μ°©λ¥™μ„ μ™„λ£ν•©λ‹λ‹¤.

### 3. μ‹λ³„λ λ¬Έμ μ  λ° ν•΄κ²° λ°©μ•

1.  **`waypoint_mission_node`μ λ§μ»¤ μ •λ³΄ λ¶€μ¬**: β… **ν•΄κ²°λ¨** - λ§μ»¤ μ„μΉ κµ¬λ…μ λ° μ½λ°± ν•¨μ κµ¬ν„ μ™„λ£
2.  **λ¨νΈν• Yaw μ μ–΄**: **λ³΄λ¥** - ν„μ¬λ” κΈ°λ³Έ μ„μΉ μ μ–΄λ¥Ό μ‚¬μ©ν•λ©°, ν•„μ” μ‹ μ¶”ν›„ κ°μ„ 
3.  **λ§μ»¤ νƒμƒ‰ μ¤‘ νΈλ²„λ§ λ¬Έμ **: β… **ν•΄κ²°λ¨** - UGV λ„μ°© ν›„ μ²μ²ν ν•κ°•ν•λ©° λ§μ»¤ νƒμƒ‰ν•λ„λ΅ λ³€κ²½
4.  **UGV-λ“λ΅  λ™κΈ°ν™” λ¶€μ¬**: β… **ν•΄κ²°λ¨** - UGV λ‘λ°λ¶€ λ„μ°© μ‹ νΈ λ° ν•κ°• ν—κ°€ λ©”μ»¤λ‹μ¦ μ¶”κ°€

### 4. ν¨ν‚¤μ§€λ³„ μƒμ„Έ κ°λ° κ³„ν

#### κ°€. `robot_control` ν¨ν‚¤μ§€

##### π”Ή `uav/waypoint_mission.py` μμ • β… **μ™„λ£**

* **κµ¬ν„ μ™„λ£ ν•­λ©**:
    1.  **`PRECISION_LANDING` μƒνƒ μ¶”κ°€**: μ •λ°€ μ°©λ¥™ μƒνƒ λ° κ΄€λ ¨ νλΌλ―Έν„° μ¶”κ°€
    2.  **λ§μ»¤ μ„μΉ κµ¬λ…μ**: `/marker_detections` ν† ν”½ κµ¬λ… λ° μ°©λ¥™ λ§μ»¤ ν•„ν„°λ§
    3.  **UGV λ„μ°© μ‹ νΈ μ²λ¦¬**: `'ugv_arrived'` λ…λ Ή μμ‹  μ‹ ν•κ°• ν—κ°€ ν”λκ·Έ μ„¤μ •
    4.  **λ‹¨κ³„λ³„ μ •λ°€ μ°©λ¥™ λ΅μ§**:
        * UGV λ―Έλ„μ°© μ‹: νΈλ²„λ§ λ€κΈ°
        * λ§μ»¤ λ―Ένƒμ§€ μ‹: μ²μ²ν ν•κ°•ν•λ©° νƒμƒ‰ (`search_descent_speed: 0.15m/s`)
        * λ§μ»¤ νƒμ§€ μ‹: 4λ‹¨κ³„ μ§€μ†μ  μ •λ°€ μ μ–΄
            * **μν‰ μ •λ ¬**: κ³ λ„ μ μ§€ν•λ©° μν‰ μ •λ ¬ (`horizontal_tolerance: 0.1m`)
            * **μ •λ°€ ν•κ°•**: μ •λ°€ μ •λ ¬ μƒνƒμ—μ„λ§ ν•κ°• (`precision_horizontal_tolerance: 0.05m`)
            * **μ¬μ •λ ¬**: ν•κ°• μ¤‘ μ •λ ¬μ΄ λ²—μ–΄λ‚λ©΄ κ³ λ„ μ μ§€ν•λ©° μ¬μ •λ ¬
            * **μµμΆ… μ°©λ¥™**: μν‰/μμ§ λ¨λ“  μ΅°κ±΄ λ§μ΅± μ‹μ—λ§ `LANDING` μƒνƒ μ „ν™

##### π”Ή `admin/mission_control_node.py` μμ • β… **μ™„λ£**

* **κµ¬ν„ μ™„λ£ ν•­λ©**:
    1.  **Mission ID μ¶”κ°€**: `UGV_RENDEZVOUS_ARRIVAL: 7` μ¶”κ°€
    2.  **UGV λ„μ°© ν”λκ·Έ**: `ugv_arrived_at_rendezvous` μƒνƒ κ΄€λ¦¬
    3.  **λ“λ΅  ν•κ°• ν—κ°€ μ‹ νΈ**: UGV λ„μ°© μ‹ λ“λ΅ μ— `'ugv_arrived'` λ…λ Ή μ „μ†΅
    4.  **λ§μ»¤ νƒμ§€ μ§€μ‹**: μ •λ°€ μ°©λ¥™ μ‹μ‘ μ‹ `multi_tracker`μ— `"DETECT_LANDING_MARKER"` λ…λ Ή μ „μ†΅

#### λ‚. `multi_tracker` ν¨ν‚¤μ§€ β… **μ™„λ£**

##### π”Ή `src/abscoord_marker_detection.cpp` λ° `include/multi_tracker/abscoord_marker_detection.hpp` μμ •

* **κµ¬ν„ μ™„λ£ ν•­λ©**:
    1.  **μ°©λ¥™ λ¨λ“ ν”λκ·Έ**: `_is_landing_mode` λ³€μλ΅ λ§μ»¤ ν¬κΈ° μ μ–΄
    2.  **λ…λ Ή κµ¬λ…μ**: `/multi_tracker/command` ν† ν”½ κµ¬λ…
    3.  **μ΅°κ±΄λ¶€ λ§μ»¤ ν¬κΈ°**: μ°©λ¥™ λ¨λ“ μ‹ 0.5m, μΌλ° λ¨λ“ μ‹ 1.0m μ‚¬μ©
    4.  **λΉλ“ μ¤λ¥ μμ •**: μ‚¬μ©ν•μ§€ μ•λ” ν•¨μ μ κ±° λ° CMake μ„¤μ • μ •μ •

### 5. κµ¬ν„ μƒνƒ λ° ν…μ¤νΈ μ¤€λΉ„

#### β… κµ¬ν„ μ™„λ£ μ‚¬ν•­

1.  **μ½”λ“ κµ¬ν„**: λ¨λ“  ν¨ν‚¤μ§€μ μ •λ°€ μ°©λ¥™ κΈ°λ¥ κµ¬ν„ μ™„λ£
2.  **λΉλ“ κ²€μ¦**: μ»΄νμΌ μ¤λ¥ λ° κ²½κ³  ν•΄κ²° μ™„λ£
3.  **λ΅μ§ κ²€μ¦**: λ‹¨κ³„λ³„ ν•κ°• λ° μ •λ ¬ μ•κ³ λ¦¬μ¦ κµ¬ν„ μ™„λ£

#### π§ λ‹¤μ ν…μ¤νΈ λ‹¨κ³„

1.  **λ‹¨μ„ ν…μ¤νΈ**: κ° λ…Έλ“λ³„ κΈ°λ¥ λ™μ‘ ν™•μΈ
2.  **ν†µν•© ν…μ¤νΈ**: μ „μ²΄ λ―Έμ… μ‹λ‚λ¦¬μ¤ μ‹¤ν–‰
3.  **λ§μ»¤ ν¬κΈ° μ „ν™ ν…μ¤νΈ**: μΌλ° λ§μ»¤(1.0m) β†’ μ°©λ¥™ λ§μ»¤(0.5m) μ „ν™ κ²€μ¦
4.  **μ •λ°€ μ°©λ¥™ μ •ν™•λ„ ν…μ¤νΈ**: μν‰/μμ§ ν—μ© μ¤μ°¨ λ‚΄ μ°©λ¥™ μ„±κ³µλ¥  μΈ΅μ •

### 6. νλΌλ―Έν„° μ„¤μ • κ°€μ΄λ“

μ •λ°€ μ°©λ¥™ μ„±λ¥ μ΅°μ •μ„ μ„ν• μ£Όμ” νλΌλ―Έν„°:

```yaml
# waypoint_mission_node νλΌλ―Έν„°
landing_altitude: 0.5                    # μµμΆ… μ°©λ¥™ κ³ λ„ (m)
descent_speed: 0.2                       # μ •λ°€ ν•κ°• μ†λ„ (m/s)
search_descent_speed: 0.15               # λ§μ»¤ νƒμƒ‰ μ¤‘ ν•κ°• μ†λ„ (m/s)
horizontal_tolerance: 0.1                # μν‰ μ •λ ¬ ν—μ© μ¤μ°¨ (m)
precision_horizontal_tolerance: 0.05     # μ •λ°€ ν•κ°• μ‹ μν‰ ν—μ© μ¤μ°¨ (m)
vertical_tolerance: 0.2                  # μμ§ ν—μ© μ¤μ°¨ (m)
landing_marker_id: 10                    # μ°©λ¥™μ© λ§μ»¤ ID

# multi_tracker_node νλΌλ―Έν„°
marker_size: 1.0                         # μΌλ° λ§μ»¤ ν¬κΈ° (m)
landing_marker_size: 0.5                 # μ°©λ¥™ λ§μ»¤ ν¬κΈ° (m)
```